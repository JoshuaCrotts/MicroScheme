;
; Another slightly simple OOP example.
;
(define (make-simple-cell value)
    (位 (selector)
        (cond ((eq? selector 'fetch)
               (位 () value))
              ((eq? selector 'store!)
               (位 (new-value)
                (set! value new-value)))
              ((eq? selector 'cell?)
               (位 () #t))
              (else "Not handled"))))

(define a-cell (make-simple-cell 13))
((a-cell 'fetch)) ;; 13
((a-cell 'store!) 21)
((a-cell 'cell?))
(define b-cell (make-simple-cell 17))
((b-cell 'fetch)) ;; 17
((b-cell 'store!) 24)
((b-cell 'cell?))
((a-cell 'fetch)) ;; 21
((b-cell 'fetch)) ;; 24
