;
; Merge sort example with large list (1000 values).
;

; Split: input is a list of objects, output is a list of two lists of
;   approximately equal size such that the set of all objects in both
;   lists is the same as the set of objects in the input list.

(define split
  (lambda (l)
    (if (null? l)
        (list '() '())
        (if (null? (cdr l))
            (list l '())
            (let ((rest (split (cdr (cdr l)))))
              (list (cons (car l) (car rest))
                    (cons (car (cdr l)) (car (cdr rest)))))))))

; Merge: input is two lists of numbers in increasing order, output is
;   a list of numbers in increasing order consisting of exactly those
;   numbers in the input list.

(define merge
  (lambda (l1 l2)
    (if (null? l1)
        l2
        (if (null? l2)
            l1
            (if (< (car l1) (car l2))
                (cons (car l1) (merge (cdr l1) l2))
                (cons (car l2) (merge (cdr l2) l1)))))))

; Merge-sort: input is a list of numbers, output is that list sorted

(define merge-sort
  (lambda (l)
    (if (null? l)
        '()
        (if (null? (cdr l))
            l
            (let ((s (split l)))
              (let ((a (car s)) (b (car (cdr s))))
                (merge (merge-sort a) (merge-sort b))))))))

(merge-sort '(-31444 -49908 36497 29520 32453 11102 39711 27040 -17246 -42277 -14875 8838 35498 13168 -10591 36399 39546 -2879 -18713 34207 13315 -39104 -10238 5173 26166 -19292 19566 32410 -8780 3993 7518 39380 -36169 31499 -15611 -47033 46815 47678 -19714 39858 8121 -7963 -3794 592 -49225 23692 -29464 45860 33705 7092 -38653 22741 7388 4343 -30427 -25043 -11401 -6629 -10800 -22011 -41228 -48582 5843 -8279 -35809 -28496 -33613 3835 7911 -37038 -907 -21937 -21796 5386 25190 10603 -10311 13041 -833 -19319 -26573 24405 30486 12037 -48600 -9655 17980 33297 22255 -17257 -1077 1595 -47803 -24792 12971 1946 30525 -17980 -46339 9761 15006 -756 -31116 -24212 14549 -24979 27149 10076 -14526 13374 10077 5368 16787 48373 -25310 45378 34883 -41139 47285 31329 18886 -18313 44578 14527 41036 -31370 -20174 49269 29351 26431 45707 -31706 -43172 42439 -11742 48750 39300 -32118 13647 15184 22973 42425 -3197 -49837 13672 -16509 15953 -4042 -33465 11579 -11743 -23092 46574 24204 21803 34648 -25721 -43442 -41554 9892 -1852 31341 -10825 5870 25171 -6627 -6284 -33404 -22770 30709 5641 -11835 1043 -34562 -10920 -23646 15958 43318 6110 -46746 33102 -2918 10281 -8294 -38033 24795 -803 12740 28219 2326 23167 20057 24275 39687 31362 -35747 -42835 29591 37111 5937 18084 6077 -47986 21612 13307 45646 31320 13729 6029 30236 38180 -7777 33292 -39722 36363 14704 13918 15337 -8381 39112 -42220 -49612 -47974 -26714 -15482 -27996 -28922 26663 28294 47630 27766 12297 -34359 35133 38201 -26005 -2336 -47803 7715 -11605 25969 -584 -33672 25334 9328 31133 19706 -42289 -40878 25758 -42111 -4621 28604 -12904 -33835 40402 -23972 -48946 -13469 -46869 -35946 19692 43779 30285 10413 -35476 -20363 273 38339 -7826 -1271 -6285 11794 21265 28940 -6455 -34644 31620 1736 6963 35884 12343 33848 -35115 -31442 44143 43622 20198 8017 36857 -36262 -21466 -20714 -21268 3084 -8225 24383 364 -32146 29677 39278 39626 30295 -37005 33686 -26657 2131 -3764 13457 -32365 -25852 6760 -5405 -25449 -3878 3925 23123 31978 30602 -11615 38404 -11172 -8663 -33458 -39735 -40452 38848 16690 26710 -47307 -29938 -39832 19647 44188 -38849 -10748 -7830 -42808 4488 35907 -45130 47939 28045 43206 48424 47393 46111 -6246 6354 4086 -29057 -12014 42344 859 39337 3036 25637 -16781 3387 13750 44058 962 20547 47709 27361 -40215 -31094 -14708 -2664 19384 -11879 -7784 -26707 26578 -37858 22813 -27294 24283 33525 8362 36782 35718 -48539 -15743 21993 11428 39530 -33190 2637 15021 -6143 -11158 -36543 -14188 43826 14829 33141 -18866 8545 28380 33126 9253 4771 2789 43424 36749 -23557 -12390 9442 2088 -6767 29347 17969 23913 -42562 -48753 33203 5670 -5673 29541 -23711 -7859 3093 -6127 14427 37348 27396 -15947 44208 17115 -28583 12797 25766 -18608 43109 -7276 -31818 -46352 15699 2519 -47623 38938 -11159 26296 41428 41727 44506 47306 -32287 -10141 29616 -13265 -28893 25015 -45920 -36701 -37308 -33619 -28601 15492 -35886 45293 -15906 34052 47121 37134 -39750 -36676 47036 -43931 -2234 -35572 28470 -11238 4655 -26104 -47909 27696 5274 31854 -25270 -30740 23991 45127 28543 30132 36139 45503 4288 -43554 4171 17833 -41484 3408 25948 4669 22437 -3240 35823 -45222 36159 12738 -35123 22812 -25753 -43219 41033 2982 7736 188 -30846 -48719 -8866 34218 -28623 44838 18620 -1432 -31983 26737 16436 -8588 -14850 -24958 -10352 -27578 20621 -27440 1826 9409 -32440 43297 5545 37832 -35636 -8807 -17077 7235 -32021 31119 22784 -2315 -38392 -42275 11200 -24945 -45978 -19806 33366 43517 -38667 13166 18947 34659 1722 20148 -42639 -14409 -12455 46270 47026 -17251 8243 41155 35667 31862 -7743 15302 -1905 -23601 -21375 48241 -5561 43861 38301 35620 25178 -41946 -37366 27136 -9142 31828 28301 12349 -45796 10992 27687 -34100 -17709 -48738 14311 14629 -44613 -3051 39748 -5361 9168 -8508 -12685 -712 22503 23203 9623 9333 23206 -39791 -35243 -29555 -20061 -40651 -22734 -6232 -3964 -17986 -35719 -21570 -45551 1297 -44204 24222 19138 -12401 -9790 14310 47262 105 36898 -26082 35100 10659 5260 -49175 42311 -42626 32987 -25921 4554 18164 -14443 -9653 -43685 -18075 -2974 35667 37637 7239 -16967 -20430 15150 -17439 -45986 2128 49825 43331 3319 -49412 10690 71 -34807 -11439 47970 20947 -39515 -44590 -34336 -44214 -7213 -20598 -12268 18433 -24462 -32427 -25160 12337 28321 -21387 42126 43374 -48872 -7908 23472 37689 -25973 24591 -4584 -33299 -24145 -32124 21985 -9210 4931 -39725 49593 44260 -49295 -15049 -27179 -29919 -48353 46601 12374 -34221 -508 8591 -26116 -37467 2526 27926 -45197 32556 -1377 15054 -19918 -17989 -7908 21157 -3122 27451 -1090 25395 -35916 -35805 -48145 -18484 37704 22473 -24363 -49435 7151 18242 22548 28096 -46185 -23550 4937 -39 32400 -48884 26698 -5502 32488 17834 -34536 6205 -32314 -9916 -27529 -6781 -10920 8770 -36636 17223 -7912 -6800 -23871 41259 -33260 -45843 29130 -47179 17615 18461 -44013 -24381 14353 26997 32998 -24602 -43603 -11786 -1520 -42122 -23139 20930 2536 -5291 18161 7582 -40705 8361 16258 -41730 24101 -22404 44508 12754 -43388 4153 19671 -11337 11538 -32720 27956 -48123 28859 6808 -16174 -22528 -14559 -43280 -29637 31580 -6972 -19021 6998 -7974 -28865 26770 47102 -32228 10634 -38672 -16094 -14877 37157 -22604 -36083 33311 35454 39551 -41157 21729 3487 18173 -38896 36099 31571 -48600 -14916 47304 -18366 29382 -19509 29346 33395 44421 919 41367 13227 30466 -29455 -17984 -507 -12439 24512 28539 -33251 -49806 -47682 30622 47093 8283 28763 9196 46967 -34579 16561 -19402 -12690 -31367 -22913 -607 -36158 23915 -42817 -44991 23911 8685 -34770 -19438 20830 13240 -469 -1517 9809 10712 -34316 32536 -10454 5050 22038 15627 -13299 8712 17003 8839 7550 -21189 -32672 34479 -2493 -6867 6968 -5346 -48174 41303 -16461 33130 4491 12466 1117 410 46356 -20294 -46080 -30327 47898 -4018 -14627 46006 -5961 -14462 -38751 14234 20160 -14073 -6599 -16778 19421 -32528 30499 23600 -14291 5873 26681 14796 27964 15697 -39580 44479 21247 17097 -28470 13785 -47328 -24986 -29126 6443 -46149 2836 -41785 45572 -28089 37618 43684 -19100 -44415 -26848 -15574 25281 -38233 33832 31710 35101 -31720 -15722 303 17660 -25218 33700 -29240 -36258 7453 -10812 -37902 40104 47871 4967 18545 48232 -34968 7317 11268 43543 -43231 20466 26617 -34682 4990 -21860 22078 -19179 -11853 -10015 35773 -45132 -3242 -43454 -16687 -7614 825 14252 42034 9422 -40960 -31361 25051 -1194 -18303 32103 ))
